<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>R：如何对坐标轴对应元素的顺序进行调整 | FENG's notes</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">R：如何对坐标轴对应元素的顺序进行调整</h1><a id="logo" href="/.">FENG's notes</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">R：如何对坐标轴对应元素的顺序进行调整</h1><div class="post-meta">2020-08-08<span> | </span><span class="category"><a href="/categories/Bioinformatics/">Bioinformatics</a></span></div><div class="post-content"><p>R作图中，坐标轴上的元素默认按照数字大小或者 Alphabetical order（字母顺序）排列。如果需要对坐标轴元素顺序进行调整，可以使用 reorder 命令。</p>
<p>例1. 柱状图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Create data</span><br><span class="line">data &lt;- data.frame(</span><br><span class="line">  name&#x3D;c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;) ,  </span><br><span class="line">  value&#x3D;c(3,12,5,18,45)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"># Barplot</span><br><span class="line">ggplot(data, aes(x&#x3D;name, y&#x3D;value)) + </span><br><span class="line">geom_bar(stat &#x3D; &quot;identity&quot;)</span><br><span class="line"># Barplot</span><br><span class="line">ggplot(data, aes(x&#x3D;reorder(name, -value), y&#x3D;value)) + </span><br><span class="line">geom_bar(stat &#x3D; &quot;identity&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="https://genehub.files.wordpress.com/2020/08/11111.jpeg"></p>
<p><img src="https://genehub.files.wordpress.com/2020/08/222222.jpeg"></p>
<p>例2. 点状图 + 多个子图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(mpg, aes(displ, hwy)) +</span><br><span class="line">  geom_point() +</span><br><span class="line">  facet_wrap(vars(class)</span><br></pre></td></tr></table></figure>

<p><img src="https://genehub.files.wordpress.com/2020/08/test1.jpeg?w=845"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># To change the order in which the panels appear, change the levels</span><br><span class="line"># of the underlying factor.</span><br><span class="line">mpg$class2 &lt;- reorder(mpg$class, mpg$displ)</span><br><span class="line">ggplot(mpg, aes(displ, hwy)) +</span><br><span class="line">  geom_point() +</span><br><span class="line">  facet_wrap(vars(class2))</span><br></pre></td></tr></table></figure>

<p><img src="https://genehub.files.wordpress.com/2020/08/reorder.jpeg?w=845"></p>
<p>其他案例：</p>
<p>Reordering groups in a <code>ggplot2</code> chart can be a struggle. This is due to the fact that ggplot2 takes into account the order of the <code>factor</code> levels, not the order you observe in your data frame. You can sort your input data frame with <code>sort()</code> or <code>arrange()</code>, it will never have any impact on your <code>ggplot2</code> output.</p>
<p>This post explains how to reorder the level of your factor through several examples. Examples are based on 2 dummy datasets:</p>
<p># Library<br>library(ggplot2)<br>library(dplyr)</p>
<h1 id="Dataset-1-one-value-per-group"><a href="#Dataset-1-one-value-per-group" class="headerlink" title="Dataset 1: one value per group"></a>Dataset 1: one value per group</h1><p>data &lt;- data.frame(<br>  name=c(“north”,”south”,”south-east”,”north-west”,”south-west”,”north-east”,”west”,”east”),<br>  val=sample(seq(1,10), 8 )<br>)</p>
<h1 id="Dataset-2-several-values-per-group-natively-provided-in-R"><a href="#Dataset-2-several-values-per-group-natively-provided-in-R" class="headerlink" title="Dataset 2: several values per group (natively provided in R)"></a>Dataset 2: several values per group (natively provided in R)</h1><h1 id="mpg"><a href="#mpg" class="headerlink" title="mpg"></a>mpg</h1><h1 id="Method-1-the-Forecats-library"><a href="#Method-1-the-Forecats-library" class="headerlink" title="Method 1: the Forecats library"></a>Method 1: the <code>Forecats</code> library</h1><hr>
<p>The <a target="_blank" rel="noopener" href="https://github.com/tidyverse/forcats">Forecats library</a> is a library from the <a target="_blank" rel="noopener" href="https://www.tidyverse.org/">tidyverse</a> especially made to handle factors in R. It provides a suite of useful tools that solve common problems with factors. The <code>fact_reorder()</code> function allows to reorder the factor (<code>data$name</code> for example) following the value of another column (<code>data$val</code> here).</p>
<p># load the library<br>library(forcats)</p>
<h1 id="Reorder-following-the-value-of-another-column"><a href="#Reorder-following-the-value-of-another-column" class="headerlink" title="Reorder following the value of another column:"></a>Reorder following the value of another column:</h1><p>data %&gt;%<br>  mutate(name = fct_reorder(name, val)) %&gt;%<br>  ggplot( aes(x=name, y=val)) +<br>    geom_bar(stat=”identity”, fill=”#f68060”, alpha=.6, width=.4) +<br>    coord_flip() +<br>    xlab(“”) +<br>    theme_bw()</p>
<h1 id="Reverse-side"><a href="#Reverse-side" class="headerlink" title="Reverse side"></a>Reverse side</h1><p>data %&gt;%<br>  mutate(name = fct_reorder(name, desc(val))) %&gt;%<br>  ggplot( aes(x=name, y=val)) +<br>    geom_bar(stat=”identity”, fill=”#f68060”, alpha=.6, width=.4) +<br>    coord_flip() +<br>    xlab(“”) +<br>    theme_bw()</p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-2-1.png"></p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-2-2.png"></p>
<p>If you have several values per level of your factor, you can specify which function to apply to determine the order. The default is to use the median, but you can use the number of data points per group to make the classification:</p>
<p># Using median<br>mpg %&gt;%<br>  mutate(class = fct_reorder(class, hwy, .fun=’median’)) %&gt;%<br>  ggplot( aes(x=reorder(class, hwy), y=hwy, fill=class)) +<br>    geom_boxplot() +<br>    xlab(“class”) +<br>    theme(legend.position=”none”) +<br>    xlab(“”)</p>
<h1 id="Using-number-of-observation-per-group"><a href="#Using-number-of-observation-per-group" class="headerlink" title="Using number of observation per group"></a>Using number of observation per group</h1><p>mpg %&gt;%<br>  mutate(class = fct_reorder(class, hwy, .fun=’length’ )) %&gt;%<br>  ggplot( aes(x=class, y=hwy, fill=class)) +<br>    geom_boxplot() +<br>    xlab(“class”) +<br>    theme(legend.position=”none”) +<br>    xlab(“”) +<br>    xlab(“”)</p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-3-1.png"></p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-3-2.png"></p>
<p>The last common operation is to provide a specific order to your levels, you can do so using the <code>fct_relevel()</code> function as follow:</p>
<p># Reorder following a precise order<br>p &lt;- data %&gt;%<br>  mutate(name = fct_relevel(name,<br>            “north”, “north-east”, “east”,<br>            “south-east”, “south”, “south-west”,<br>            “west”, “north-west”)) %&gt;%<br>  ggplot( aes(x=name, y=val)) +<br>    geom_bar(stat=”identity”) +<br>    xlab(“”)<br>#p</p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-5-1.png"></p>
<h1 id="Method-2-using-dplyr-only"><a href="#Method-2-using-dplyr-only" class="headerlink" title="Method 2: using dplyr only"></a>Method 2: using <code>dplyr</code> only</h1><hr>
<p>The <code>mutate()</code> function of <code>dplyr</code> allows to create a new variable or modify an existing one. It is possible to use it to recreate a factor with a specific order. Here are 2 examples:</p>
<ul>
<li>  The first use <code>arrange()</code> to sort your data frame, and reorder the factor following this desired order.</li>
<li>  The second specifies a custom order for the factor giving the levels one by one.</li>
</ul>
<p>data %&gt;%<br>  arrange(val) %&gt;%    # First sort by val. This sort the dataframe but NOT the factor levels<br>  mutate(name=factor(name, levels=name)) %&gt;%   # This trick update the factor levels<br>  ggplot( aes(x=name, y=val)) +<br>    geom_segment( aes(xend=name, yend=0)) +<br>    geom_point( size=4, color=”orange”) +<br>    coord_flip() +<br>    theme_bw() +<br>    xlab(“”)</p>
<p>data %&gt;%<br>  arrange(val) %&gt;%<br>  mutate(name = factor(name, levels=c(“north”, “north-east”, “east”, “south-east”, “south”, “south-west”, “west”, “north-west”))) %&gt;%<br>  ggplot( aes(x=name, y=val)) +<br>    geom_segment( aes(xend=name, yend=0)) +<br>    geom_point( size=4, color=”orange”) +<br>    theme_bw() +<br>    xlab(“”)</p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-6-1.png"></p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-6-2.png"></p>
<h1 id="Method-3-the-reorder-function-of-base-R"><a href="#Method-3-the-reorder-function-of-base-R" class="headerlink" title="Method 3: the reorder() function of base R"></a>Method 3: the <code>reorder()</code> function of base R</h1><hr>
<p>In case your an unconditional user of the good old R, here is how to control the order using the <code>reorder()</code> function inside a <code>with()</code> call:</p>
<p># reorder is close to order, but is made to change the order of the factor levels.<br>mpg$class = with(mpg, reorder(class, hwy, median))</p>
<p>p &lt;- mpg %&gt;%<br>  ggplot( aes(x=class, y=hwy, fill=class)) +<br>    geom_violin() +<br>    xlab(“class”) +<br>    theme(legend.position=”none”) +<br>    xlab(“”)<br>#p</p>
<p><img src="https://www.r-graph-gallery.com/267-reorder-a-variable-in-ggplot2_files/figure-html/unnamed-chunk-8-1.png"></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2020/08/09/%E8%BD%AC%EF%BC%9A%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0%E4%BB%A3%E7%A0%81%E5%88%B0github/">转：如何上传代码到github</a><a class="next" href="/2020/08/05/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AF%B9%E5%A4%9A%E9%87%8D%E6%A3%80%E9%AA%8C%E5%BE%97%E5%88%B0%E7%9A%84p%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%A0%A1%E6%AD%A3/">为什么要对多重检验得到的P值进行校正</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Bioinformatics/">Bioinformatics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Notes/">Notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Plant/">Plant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Tag/" style="font-size: 15px;">Tag</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/12/25/Linux%EF%BC%9Avim%E8%AE%BE%E7%BD%AE/">Linux：vim设置</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/15/%E4%B8%80%E4%BA%9BFASTA-FASTQ%E5%BA%8F%E5%88%97%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/">一些FASTA/FASTQ序列处理工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/12/%E5%A4%A7%E8%B1%86%E4%BA%A7%E4%B8%9A%E7%8E%B0%E7%8A%B6/">大豆产业现状</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/07/1st_post/">My Fast HexoPages</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/07/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/06/%E5%AE%89%E8%A3%85hic-pro/">安装HiC-Pro （HiC数据预处理工具）</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/05/%E4%B8%A4%E4%B8%AA%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%BA%8F%E5%88%97%E7%9B%B8%E4%BA%92%E6%AF%94%E8%BE%83%EF%BC%9Amummer/">两个基因组序列相互比较：Mummer</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/05/shell%E8%84%9A%E6%9C%AC%E5%92%8Cperl%E8%84%9A%E6%9C%AC%E7%9A%84%E6%AE%B5%E6%B3%A8%E9%87%8A/">shell脚本和perl脚本的段注释</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/16/R%EF%BC%9Acorrplot-%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0%E7%9F%A9%E9%98%B5-/">R：corrplot 相关系数矩阵</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/16/R%EF%BC%9A%E7%BB%8F%E9%AA%8C%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0-/">R：经验分布函数</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">FENG's notes.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>